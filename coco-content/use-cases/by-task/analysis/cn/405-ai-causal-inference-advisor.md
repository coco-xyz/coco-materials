# 用例 #405：AI 因果推断顾问

**角色**：数据科学家 / 机器学习工程师 | **行业**：SaaS、科技、企业 | **任务**：分析、因果推断、决策科学

---

## 详细介绍

**痛点：将相关性误认为因果关系导致代价高昂的决策**

在应用数据科学中，最昂贵且持续存在的错误之一是在业务决策中将相关性与因果关系混淆。这种模式是一致且可预测的：数据分析师观察到采用功能 X 的客户比未采用的客户 12 个月留存率高 40%。由此得出的业务结论是扩大功能 X 的采用将增加留存率。随之而来的是产品投资：一个团队被分配来改进功能 X 的发现和引导，代价是大量工程和产品时间。十二个月后，留存率曲线没有移动。事后剖析最终揭示，采用功能 X 的用户已经是高价值、高参与度的客户——那种无论功能 X 如何都会留存的客户。功能没有导致他们留存；他们的基础参与度水平既导致了功能采用又导致了留存。改进功能发现没有解决潜在驱动因素，所以留存率没有提高。这类错误并不罕见——它是将基于相关性的业务分析应用于需要因果推理的决策时的默认结果。

问题的根源在于观测数据——大多数组织大部分时间拥有的数据——捕获相关性但不捕获因果关系。当用户自我选择进入处理（功能采用、订阅层级升级、支持票提交、参加网络研讨会），处理组和对照组不仅在处理状态上不同，而且在驱动其处理选择的所有特征上也不同。这就是选择偏差，它系统性地使处理组和未处理组之间的比较无效。一家 SaaS 公司观察到参加网络研讨会的客户的扩展收入比未参加的高 30%，不能得出网络研讨会导致扩展的结论——参加网络研讨会的客户已经更加投入，拥有更高的产品采用率，并且更可能出于完全独立于网络研讨会出席的原因而扩展。相关性是真实的；因果主张是无效的。

因果推断的方法论工具包在学术计量经济学和统计学中已经发展成熟——随机对照试验（A/B 测试）、差异中的差异、工具变量、回归断续性、倾向得分匹配和合成控制方法都是已建立的方法，有已知的假设和失败模式。挑战在于大多数在行业中工作的数据科学家在这个工具包中的培训有限，特别是观测方法。许多从业者知道如何运行 A/B 测试，但没有深入研究当 A/B 测试不可能时哪种观测方法是适当的替代、该方法要求什么假设，以及如何测试这些假设是否在他们的特定数据集中成立。结果是当实验不可用时，从业者要么默认进行基于相关性的分析（产生无效的因果主张），要么宣告"我们无法严格回答这个问题"（完全放弃分析）。

沟通问题同样重要。即使数据科学家成功应用了因果推断方法并获得了有效的因果估计，向业务利益相关方传达发现也需要谨慎的语言。业务利益相关方经常将回归输出、倾向得分匹配结果和差异中的差异估计解读为因果事实，而潜在假设可能不成立。当必须做出实际业务决策时，他们也经常无视伴随着"我们无法从这些数据得出因果关系"的发现。数据科学家必须在夸大因果确定性（当假设失败时驱动错误决策）和低估发现到不提供任何决策指导之间导航。这需要判断如何将因果语言的强度校准到识别策略的强度——一种结合统计知识和沟通技巧的技能。

**COCO 如何解决这一问题**

COCO 作为因果推断顾问——帮助数据科学家和分析师导航完整的因果分析工作流，从识别因果问题到选择识别策略、解释结果，以及以适当的因果语言向业务利益相关方传达发现。

1. **因果问题表述**：COCO 帮助将业务问题转化为精确定义的因果问题——在任何分析开始之前明确处理、结果、人群、反事实和时间范围。
   - 识别业务问题何时本质上是因果性的（如果发生什么会怎样？）与描述性的（发生了什么？），并应用适当的分析框架
   - 揭示业务问题中需要明确的隐藏假设，然后才能设计有效的因果分析

2. **选择偏差和混淆识别**：COCO 进行结构化因果识别审计——识别威胁提议分析有效性的混淆变量、选择机制和反向因果路径。
   - 使用有向无环图（DAG）推理来绘制问题的因果结构并识别需要阻断的后门路径
   - 识别哪些变量应该被条件化，哪些不应该，以及原因（碰撞器偏差、中介分析区别）

3. **识别策略选择**：COCO 根据可用数据、实验可能性和可以可信维护的假设，推荐适当的因果识别策略。
   - 涵盖完整工具包：随机实验（A/B 测试、切换实验）、差异中的差异、合成控制、工具变量、回归断续性、倾向得分方法和因果森林
   - 规定每种方法的核心识别假设，并提供如何在背景中测试或论证这些假设的指导

4. **假设测试和敏感性分析**：COCO 设计评估所选识别策略的基础假设是否在数据中成立的实证测试。
   - 为差异中的差异设计平行趋势测试、安慰剂测试、匹配方法的平衡测试，以及工具变量的第一阶段 F 统计量检查
   - 推荐 Rosenbaum 边界或其他量化颠覆结论所需的未测量混淆程度的敏感性分析

5. **结果解释和效应量沟通**：COCO 以业务术语解释因果效应估计——将平均处理效应、局部平均处理效应和异质处理效应转化为可操作的业务发现。
   - 区分平均处理效应（ATE）、处理组的平均处理效应（ATT）和局部平均处理效应（LATE），并解释哪个与每个业务决策相关
   - 解释效应异质性以识别哪些子群体从处理中受益最多

6. **面向利益相关方的因果与相关语言**：COCO 起草将因果语言精确校准到识别策略强度的沟通——既不夸大确定性也不放弃发现。
   - 为沿着光谱的发现提供语言："这是在这些假设下的有效因果估计"到"这与因果关系一致但不能证明"到"这纯粹是描述性的，不应用于预测干预效应"
   - 设计从因果发现得出的决策建议，考虑效应量不确定性

**可量化的成果**

- **因果分析错误率**：从观测相关性做出无效因果主张的业务分析比例 → 71% 基线（行业范围估计）→ 采用因果识别协议后 28%
- **A/B 测试决策质量**：实验后发现实验被新奇效应、网络效应或 SUTVA 违规混淆的比率 → 34% → COCO 指导实验设计审查后 9%
- **观测研究严谨性**：在报告因果估计之前包含正式假设测试的观测分析比例 → 8% → 因果推断框架采用后 63%
- **数据分析业务决策 ROI**：数据科学分析告知的业务决策的投资回报 → 改进集中在使用因果而非相关分析的案例
- **数据科学可信度分数**：内部利益相关方对数据科学建议的信任 → 试点团队分析质量提升后提高 38 分，以重复分析请求率衡量

**受益角色**

- **数据科学家**：发展严谨的因果推断技能，将分析从"这是我们观察到的"转化为"如果我们干预会发生什么"——大幅提升工作的决策价值
- **产品分析师**：为产品实验设计和事后观测分析应用正确的识别策略——防止将相关性视为因果关系导致的功能投资错误
- **增长分析师**：使用因果框架以适当严谨性评估营销和增长干预效果，区分渠道归因和队列分析中真实的提升与选择效应
- **业务领导者和决策者**：收到明确校准的因果发现，附明确的假设声明——在理解支持它们的因果证据置信度的同时做出更好的决策

---

## 实用提示词

**提示词 1：因果问题表述和 DAG 构建**
```
我有一个想要严格回答的业务问题。帮我将其表述为精确的因果问题并绘制因果结构。

业务问题（当前陈述）：[您的当前问题——例如"使用我们的高级分析功能是否会增加客户留存率？"]
背景：
- 我们观察到的：[描述引发问题的相关性或模式]
- 感兴趣的处理/干预：["原因"是什么]
- 感兴趣的结果：["效果"是什么]
- 人群：[我们关心哪些客户/用户/单位]
- 时间范围：[处理后多长时间测量结果]

已知混淆变量（可能同时解释处理和结果的变量）：
[列出您认为可能是混淆变量的变量]

帮我：
1. 将问题重新表述为精确的因果问题（使用潜在结果符号或通俗语言）
2. 识别反事实：如果受处理的单位没有接受处理，会发生什么？
3. 构建描述因果结构的有向无环图（DAG）——列出节点、边和任何后门路径
4. 识别因果图中的所有混淆变量、碰撞器和中介变量
5. 指定我需要控制什么以及我绝对不能控制什么以获得有效的因果估计
6. 标记任何反向因果路径（结果可能导致处理的情况）
```

**提示词 2：识别策略选择**
```
我想估计因果效应，但需要帮助根据我的数据和背景选择正确的识别策略。

因果问题：[精确陈述的因果问题]
结果变量：[您正在测量的内容]
处理：[处理是什么]

数据情况：
- 我可以运行随机实验吗？[是 / 否 / 部分——解释限制]
- 可用样本量：[处理组和对照组的大致 N]
- 时间维度：[我有面板数据（重复观测）吗？如果有，有多少个时期？]
- 可用的处理前数据：[处理前有多少个时期？]
- 潜在工具变量：[是否有影响处理但不直接影响结果的外部因素？]
- 可用的自然实验：[数据中是否有任何不连续性、推出或政策变化？]

对每种适用的识别策略，解释：
1. 给定我的数据情况，它是否适用
2. 此方法需要的核心识别假设
3. 我如何测试该假设在我的数据中是否成立
4. 我将估计的因果效应类型（ATE、ATT、LATE 等）
5. 此方法在类似我的情境中的已知失败模式

推荐主要识别策略和备用方案，并解释什么证据会说服您（和持怀疑态度的审查员）识别是有效的。
```

**提示词 3：A/B 测试设计的因果有效性**
```
我正在设计一个随机实验，想确保它将产生有效的因果估计。

实验背景：
- 正在测试的内容：[处理描述]
- 假设：[您期望发生什么以及原因]
- 主要指标：[结果指标]
- 次要/护栏指标：[要监控的其他指标]
- 随机化单位：[用户 / 会话 / 账户 / 市场 / 其他]
- 预期处理效应量：[我关心的最小可检测效应]
- 可用流量：[符合实验条件的日活跃用户或事件]

识别并帮助我解决以下设计威胁：
1. SUTVA 违规：一个单位的处理能影响其他单位的结果吗（网络效应、市场效应、共享基础设施）？
2. 新奇效应：用户行为是否会仅仅因为体验是新的而改变，产生随后逆转的临时效应？
3. 样本比例不匹配：我应该在实验期间运行哪些检查来检测随机化失败？
4. 多重检验：如果我有多个主要指标或计划中期分析，如何控制第一类错误？
5. 交互效应：是否有同时运行的预先存在的实验可能污染结果？
6. 外部有效性：在将这个实验的人群推广到更广泛用户群时，我应该说明哪些限制？

生成一个实验前设计审查清单和我在启动前需要运行的统计功效计算。
```

**提示词 4：差异中的差异分析设计**
```
我想使用差异中的差异方法从观测数据估计因果效应。帮我设计分析。

设置：
- 处理：[发生了什么——例如"我们为队列 X 的用户推出了新的引导流程"]
- 处理时间：[处理发生的时间]
- 处理组：[哪些单位接受了处理]
- 对照组（提议）：[您计划用作对照的哪些单位]
- 结果：[您正在测量什么]
- 可用的处理前时期：[处理前有多少个时期]
- 可用的处理后时期：[处理后有多少个时期]

帮我设计 DiD 分析，涵盖：
1. 平行趋势假设：如何测试处理组和对照组在处理前趋势相似？什么视觉和统计证据支持或破坏这一点？
2. 对照组选择：我提议的对照组是否合适？我应该考虑哪些替代对照组？
3. 混淆变量：与处理同时发生的其他什么事件可能混淆我的估计？
4. TWFE 模型规格：我应该估计什么回归模型？我是否应该包括单位固定效应、时间固定效应或协变量？为什么？
5. 聚类标准误：我应该在哪个层次上聚类？如果聚类太少会发生什么？
6. 安慰剂测试：我应该运行哪些安慰剂测试来评估估计的可信度？
7. 异质处理效应：如何测试效应是否在子群体间有所不同？
```

**提示词 5：向业务利益相关方传达因果发现**
```
我已完成因果分析，需要向将用其做出重大投资决策的业务利益相关方传达发现。

分析背景：
- 回答的业务问题：[您着手回答的问题]
- 使用的方法：[您的识别策略]
- 关键假设：[您的分析依赖的主要识别假设]
- 假设测试：[您测试假设的程度——您发现了什么]
- 因果估计：[效应量和置信区间]
- 样本：[N 个单位，时间段]
- 正在做的决策：[此分析之后将做出什么业务决策]
- 利害关系：[决策成本]

帮我起草沟通：
1. 以业务语言陈述发现：处理对结果的估计效应是什么，用业务单位表达？
2. 校准因果语言以匹配我的识别强度：我是否有理由说"导致"或应该说"与...相关"或"我们估计，在假设...的前提下"？
3. 以通俗语言解释关键假设：这个估计有效需要什么是真实的？
4. 量化不确定性：效应的现实范围是什么，业务应该为什么范围的结果做计划？
5. 陈述建议：鉴于这个因果证据，什么行动是合理的？什么进一步的证据会加强建议？
6. 应对最可能的反驳：持怀疑态度的利益相关方会挑战什么，我应该如何回应？
```

---
