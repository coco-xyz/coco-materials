# Use Case #230: AI Security Incident Forensics Assistant

**Role**: Developer / Security Engineer / DevOps Engineer / Incident Responder | **Industry**: Technology, SaaS, Fintech, Healthcare, Enterprise Software | **Task**: Security Incident Investigation, Digital Forensics, Incident Timeline Analysis

---
## 详细介绍

**痛点：安全事故的展开速度超过人类的分析能力**

安全事故——无论是数据泄露、勒索软件感染、内部威胁还是外部入侵——同时是一场技术危机和一次取证调查。响应团队必须同时做两件事：遏制正在进行的攻击，以及调查已经发生的事情。这两个目标往往相互矛盾：遏制行动会销毁证据；调查需要时间，而这段时间让损失继续扩大。现代云原生环境中涉及的取证数据量——TB 级的日志、数十万个网络事件、数千个文件系统变更——简单来说已超出人类分析师在可用时间内能手动处理的范围。

攻击者的优势在于方法论。成熟的威胁行为者以系统性的精准度遵循已知框架（MITRE ATT&CK、网络杀伤链）。他们通过删除日志和篡改时间戳来抹除痕迹。他们建立多个持久化机制，使得从一个载体驱逐他们并不能终止入侵。他们使用被盗凭证进行横向移动，模仿合法行为以融入正常流量模式。捕获这一切需要对数百万事件进行模式识别——这正是人类分析师在原则上能做到但无法扩展到现代事故产生的数据量的那种分析。

文档化负担使技术挑战雪上加霜。遏制之后，组织面临监管通知时限（GDPR 72 小时，HIPAA 60 天）、法律证据保全要求、高管沟通需求，以及组织事后复盘流程——而此时安全团队已精疲力竭。律师、监管机构和保险公司需要的取证报告通常需要 2–4 周的手动分析。已经花了 72 小时以上遏制事故的团队，还要面对又一个月的文档工作。

**COCO 如何解决**

COCO 的 AI 安全事故取证助手分析安全事故产物——日志、网络捕获、文件系统变更、内存转储和端点遥测——并生成结构化的、基于时间线的取证报告，将数周的分析压缩至数小时。

1. **多源产物分析**：COCO 摄取取证产物的完整谱系。
   - 处理来自任何来源的应用日志、访问日志、认证日志和审计日志
   - 分析网络捕获（PCAP 文件、NetFlow 数据、DNS 查询日志、防火墙日志），重建网络层活动
   - 检查文件系统活动：来自 EDR 工具、Windows 事件日志、Linux auditd 或云存储访问日志的创建、修改、删除事件
   - 处理认证事件：失败的登录尝试、成功的认证、权限变更、新账户创建
   - 分析云 API 审计日志（AWS CloudTrail、GCP 审计日志、Azure 活动日志），查找基础设施层的攻击者活动

2. **MITRE ATT&CK 技术映射**：将事故发现与行业标准框架关联。
   - 将观察到的攻击者行为映射到具体的 MITRE ATT&CK 技术和子技术
   - 识别哪些战术（Tactics）有体现：初始访问、执行、持久化、权限提升、防御规避、凭证访问、发现、横向移动、收集、数据渗漏、影响
   - 利用 ATT&CK 映射建议还应寻找哪些攻击者活动——如果观察到技术 A，同一威胁行为者通常还会使用相关技术 B 和 C
   - 基于技术选择评估威胁行为者的成熟度级别

3. **攻击时间线重建**：发生了什么的时间顺序叙事。
   - 自动关联所有摄取数据源的事件，统一规范到共同时间戳
   - 重建完整的攻击时间线：初始入侵 → 横向移动 → 持久化建立 → 数据访问/渗漏 → 被发现
   - 识别"零号病人"——入侵的第一个指标，通常早于触发响应的告警数小时或数天
   - 确定攻击者驻留时间：他们在环境中潜伏了多久才被发现？
   - 在时间线中标记调查人员的行动，以区分攻击者活动和响应者活动

4. **入侵指标（IoC）提取**：来自事故的可操作威胁情报。
   - 提取所有观察到的 IoC：IP 地址、域名、文件哈希、User Agent、URL 模式、注册表键、计划任务名称
   - 对照威胁情报订阅源验证 IoC，识别已知的恶意基础设施
   - 以 STIX/TAXII 格式生成可共享的 IoC 报告，用于与安全工具集成
   - 识别攻击者基础设施模式以进行威胁行为者归因

5. **入侵范围评估**：什么被访问、触碰或带走了？
   - 识别攻击者在入侵期间访问的所有系统
   - 绘制数据访问范围：哪些文件、数据库表、S3 存储桶或密钥被访问？
   - 评估数据渗漏：数据是否被转移到外部？多少？去向哪里？
   - 识别被盗凭证：哪些账户被攻击者使用或可能被访问？
   - 判断攻击者是否仍然存在并活跃（活跃威胁 vs. 历史事故）

6. **监管与法律报告生成**：遏制之后的文档工作。
   - 生成适合法律审查的结构化取证报告，附证据保管链文档
   - 为领导层沟通生成执行摘要（非技术性，以影响为重点）
   - 为安全团队和保险目的创建技术取证报告
   - 起草含 GDPR、HIPAA 或其他适用框架所需要素的监管通知
   - 生成证据保全检查清单，确保整个过程中维持取证完整性

**可量化的结果**

- **分析速度**：取证时间线重建从 2–4 周的手动工作压缩至 COCO 辅助下的 12–24 小时
- **攻击者驻留时间发现**：COCO 识别事故实际开始时间平均比手动分析早 72 小时，揭示完整范围
- **IoC 完整性**：自动提取识别的 IoC 数量是手动日志审查的 3–5 倍
- **监管时限**：GDPR 72 小时通知在 85% 的案例中在要求时限内起草并审查完毕（无辅助时仅 30%）
- **覆盖完整性**：COCO 辅助的调查检查的日志量是人类分析师能手动审查的 10–50 倍
- **事故复发率**：有完整取证报告的组织，事故复发率降低 60%（根本原因被充分理解和修复）

**受益角色**

- **安全工程师 / 事故响应人员**：在系统性分析支持下处理更大、更复杂的事故——无需完整的取证团队
- **DevOps 工程师 / SRE**：在结构化取证指导下调查其运营系统中的安全异常
- **工程领导层**：了解事故的完整范围和时间线，以准确评估业务影响
- **法律 / 合规团队**：在压缩的时间线内收到以分析为依据的监管通知和法律证据包

---

## 实用提示词

**提示词 1：初始入侵调查**
```
我们发现了潜在的安全事故，需要取证分析来了解发生了什么。

事故背景：
- 告警/触发原因：[导致你怀疑发生事故的原因：告警、用户报告、异常流量等]
- 受影响系统：[列出认为涉及的系统]
- 发现时间戳：[事故被检测到的时间]
- 疑似范围：[数据泄露 / 未授权访问 / 恶意软件 / 内部威胁 / 其他]
- 云环境：[AWS / GCP / Azure / 本地 / 混合]

可用产物（粘贴或附件）：
- 认证日志（过去 72 小时）：[粘贴样本或附件]
- 受影响系统的访问日志：[粘贴样本或附件]
- 网络日志 / 防火墙日志：[是/否]
- EDR/端点告警：[如有，粘贴]
- 云审计日志（CloudTrail/GCP Audit/Azure Activity）：[是/否]

已知事实：
- 受影响账户/用户：[如已知]
- 已知恶意 IP 或文件：[如果有告警有具体 IoC]
- 目前已采取的遏制行动：[列出已做的事]

请：
1. 从提供的产物中重建攻击时间线
2. 识别零号病人和初始入侵向量
3. 将观察到的行为映射到 MITRE ATT&CK 技术
4. 确定入侵范围（访问的系统、访问的数据）
5. 提取所有入侵指标（IoC）
6. 识别威胁行为者是否仍然存在
7. 如果仍有遏制缺口，推荐立即的遏制行动
```

**提示词 2：事后取证报告**
```
我们的事故已被遏制。我需要为 [法律 / 监管 / 保险 / 内部] 目的生成取证报告。

事故摘要：
- 事故类型：[数据泄露 / 勒索软件 / 未授权访问 / 内部威胁]
- 时间线：[开始日期] 至 [结束日期/遏制日期]
- 受影响系统：[列出]
- 可能被访问的数据：[描述数据类别]
- 确认的数据渗漏：[是 / 否 / 未知]
- 受影响的用户/账户：[数量，类别]

收集的证据：
- 分析的日志来源：[列出]
- 覆盖的时间段：[日期范围]
- 调查的关键发现：[总结你已知的内容]

报告要求：
- 监管框架：[GDPR / HIPAA / PCI DSS / SEC / 州级泄露通知法 / 仅内部]
- 通知截止日期：[如适用]
- 受众：[法律团队 / 监管机构 / 董事会 / 保险 / 全部]

请生成：
1. 执行摘要（1 页，非技术性）
2. 带时间戳的详细取证时间线
3. 根本原因分析
4. 入侵范围评估
5. 攻击者技术和目的的证据
6. [如适用，起草含所需数据要素的监管通知]
7. 已完成和待完成的修复行动
8. 防止复发的建议
```

**提示词 3：可疑活动的日志分析**
```
我有一些可疑日志，需要帮助判断这是否是一起安全事故。

系统背景：
- 系统：[Web 服务器 / 数据库 / API 网关 / 云账户 / 端点]
- 正常行为基线：[描述这个系统的正常状态]
- 为何看起来可疑：[描述你观察到的让你产生顾虑的内容]

可疑日志片段：
[粘贴可疑的日志条目——包括时间戳、来源 IP、User Agent、执行的操作]

需要回答的问题：
1. 这与已知的攻击模式一致吗？是哪种模式？
2. 对这种活动最可能的解释是什么？
3. 是否有成功入侵的证据，或者只是尝试攻击？
4. 我应该收集哪些额外的日志或产物来确认/否定？
5. 建议的立即响应措施是什么？
6. 可能涉及哪些 MITRE ATT&CK 技术？
7. 是否有应立即在防火墙/WAF 封锁的 IoC？
```
